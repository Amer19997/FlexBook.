@page
@model WebUI.Pages.Banner.IndexModel
@Html.AntiForgeryToken()
@if (!string.IsNullOrEmpty(Model.Error))
{
    <span style="color:red"> . @Model.Error</span>

    <br />
}

@if (Model.BannerRequest.BanneritemsDto.Any())
{
    <div class="app-heading d-flex justify-content-between">

        <div class="app-title">

            <h3 class="m-0">قائمة محتوى البانر</h3>
        </div>

        <div class="app-heading-end d-flex filter-form">

            <a class="btn btn-tertiary line-befor me-5" href="/Banner/CreateBanner">
                اضف بانر
                @*<img src="~/cms_lib/img/icons/" alt="details-icon" class="icons" />*@
            </a>
        </div>

    </div>
    <div id="search-result">
        <partial name="_BannerList.cshtml" model="@Model.BannerRequest" />
    </div>



    <div class="modal fade body-modal" id="deleteModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
     aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-md modal-dialog-centered">
            <div class="modal-content text-center">
                <div class="modal-body">
                    <span class="ps-1"><img src="~/cms_lib/img/icons/deletePopup.svg" alt="details-icon" class="icons" /></span>

                    <h3>هل تريد حذف  البانر ؟</h3>
                    <p>
                        في حالة الموافقة علي الحذف لن تستطيع <br />استعادة البيانات مره اخرى
                    </p>
                </div>
                <div class="modal-button">


                    <a id="YesValue" date-id="" class="btn btn-primary">نعم</a>
                    <button class=" btn btn-light-primary" data-bs-dismiss="modal">لا</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade body-modal" id="DeleteSuccess" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-md modal-dialog-centered">
            <div class="modal-content text-center">
                <div class="modal-body text-center">
                    <span class="ps-1"><img src="~/Cms_Lib/img/icons/add-user-popup.svg" alt="details-icon" class="icons" /></span>
                    <h3 id="MessageSuccess"></h3>

                </div>

            </div>
        </div>
    </div>

}
else
{

    <div class="parent w-100 h-100">
        <div class="child">
            <div>
                <img src="~/Cms_Lib/img/icons/no-users-icon.svg" alt="search-icon" />

            </div>

            <div>
                <h2>لا يوجد طلبات جديده</h2>
                <a class="btn btn-tertiary line-befor" href="/Banner/CreateBanner">
                    اضف بانر
                </a>
            </div>
        </div>

    </div>
}






@section scripts {
    <script src="~/lib/jquery-ajax-unobtrusive/jquery.unobtrusive-ajax.min.js"></script>
    <script>

        $('.filteration').on('change', function (e) {
            var Getval = $(this).val();
            if (Getval != '') {
                $('.btnclose').removeClass('d-none');
                $('.btnclose').addClass('d-block');
            } else {
                return false;
            }
        });


        function DeleteModal(id) {

            $('#YesValue').attr('date-id', id);
            $("#deleteModal").modal('show');
        }


        $('#YesValue').on('click', function () {

            var GetId = $(this).attr('date-id');
            $.ajax({
                url: "?handler=DeleteBanner",
                method: "GET",
                data: { "BannerId": GetId },
                success: function (response) {
                    debugger
                    console.log(response)
                    $('#deleteModal').modal('hide');

                    $('#MessageSuccess').text('تم حذف البانر ')

                    $("#DeleteSuccess").modal('show');
                    setTimeout(function () {
                        window.location.href = "/Banner/Index";
                    }, 3000);
                }
            });

        })

    </script>

}
